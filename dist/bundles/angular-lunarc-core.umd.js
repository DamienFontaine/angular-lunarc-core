!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("angular2-jwt/angular2-jwt")):"function"==typeof define&&define.amd?define("@lunarc/core",["exports","@angular/core","@angular/common/http","angular2-jwt/angular2-jwt"],e):e(t["angular-lunarc-core"]={},t.core,t.http,t.angular2Jwt)}(this,function(t,e,r,n){"use strict";var o=function(){return function(t){this.Id=t.Id,this.Username=t.Username,this.Email=t.Email}}(),u=function(){function t(){}return t.prototype.create=function(t){return new o(t)},t}(),i=function(){function t(t){this.http=t}return t.prototype.get=function(t){return this.http.get("/user/"+t.Id)},t.prototype.query=function(){return this.http.get("/user")},t.prototype.save=function(t){return this.http.post("/user",t)},t.prototype.update=function(t){return this.http.put("/user/"+t.Id,t)},t.prototype.delete=function(t){return this.http.delete("/user/"+t.Id)},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t}(),s=function(){function t(t){this.userFactory=t,this.jwtHelper=new n.JwtHelper}return t.prototype.setCredentials=function(){var t=localStorage.getItem("id_token"),e=this.jwtHelper.decodeToken(t);this.user=this.userFactory.create({Email:e.email,Id:e.id,Username:e.username})},t.prototype.storeToken=function(t){localStorage.setItem("id_token",t),this.setCredentials()},t.prototype.isAuthenticated=function(){var t=localStorage.getItem("id_token");try{this.jwtHelper.decodeToken(t);if(this.jwtHelper.isTokenExpired(t))return delete this.user,!1;this.setCredentials()}catch(t){return!1}return!0},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:u}]},t}(),c=function(){function t(){this.queue=[],this.currentMessage=""}return t.prototype.set=function(t){this.queue.push(t)},t.prototype.get=function(){return this.queue.length>0&&(this.currentMessage=this.queue.shift()),this.currentMessage},t.prototype.clear=function(){this.currentMessage=""},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[]},t}(),a=function(){return function(t){this.message=t.message,this.to=t.to,this.from=t.from||""}}(),p=function(){function t(){}return t.prototype.create=function(t){return new a(t)},t}(),l=function(){function t(t){this.http=t}return t.prototype.send=function(t){return this.http.post("/mail",t)},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t}(),f=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[r.HttpClientModule],providers:[i,u,l,p,c,s]}]}],t.ctorParameters=function(){return[]},t}();t.CoreModule=f,t.UserService=i,t.User=o,t.UserFactory=u,t.MailService=l,t.MailFactory=p,t.Mail=a,t.FlashService=c,t.AuthService=s,Object.defineProperty(t,"__esModule",{value:!0})});
